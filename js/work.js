var addWork=function(l,r){var o="",c={addCirclePhotoBtn:document.getElementById("addCirclePhotoBtn"),done:document.getElementById("done"),txt:document.getElementById("work-text"),title:document.getElementById("work-title"),addCircleVideoBtn:document.getElementById("addCircleVideoBtn"),pageTitle:document.querySelector(".mui-title")},d=0,u=!1,m=[],i=!0,n=function(e,t){var o,i,n,a,s;o={photoListId:"video"==(t=t||"image")?"publishVideoList":"publishPhotoList",src:e},i=t,n=document.getElementById(o.photoListId),a=document.createElement("li"),s=o.src,console.log("11111"+i),"video"==i&&(a.className="video_li"),s&&"image"==i?(a.innerHTML='<img class="icon-remove" src="../../assets/images/squadron/cancel.png" /><img class="circle-photo-item" src="'+s+'"/>',n.insertBefore(a,c.addCirclePhotoBtn)):(a.innerHTML='<img class="icon-remove icon-remove-video" src="../../assets/images/squadron/cancel.png" /><div class="video_target" data-target="'+s+'"><img class="video-item" src="../../assets/images/space/play.png"/></div>',n.insertBefore(a,c.addCircleVideoBtn)),"image"==t?d++:0},a=function(e){u=e},t=function(){var e=0;if(i=!0,plus.storage.getItem("HOMEWORK")&&""!=plus.storage.getItem("HOMEWORK")){for(var t=JSON.parse(plus.storage.getItem("HOMEWORK")),o=0;o<t.attachment.length;o++)"image"==t.attachment[o].type?m.push(t.attachment[o].attachment):"video"==t.attachment[o].type&&(n(t.attachment[o].attachment,"video"),e=1);(function(e){c.txt.value=e.txt,c.title.value=e.title;for(var t=0;t<e.src.length;t++)n(e.src[t])})({txt:t.homeworkDetail.content||"",title:t.homeworkDetail.title||"",src:m});return e}},g=function(e){console.log("上传作业参数："+JSON.stringify(e)),plus.nativeUI.showWaiting("发布中..."),l.dataUtil.addWork(e,function(e){plus.nativeUI.closeWaiting(),console.log("===新增作业==="+JSON.stringify(e)),(e=e||{}).data=e.data||{},1==e.data.SystemCode?(r.toast("提交成功"),r.fire(plus.webview.currentWebview().opener(),"addSuccess",{}),r.fire(plus.webview.getWebviewById("squadronIdx"),"afterAdd",{}),r.fire(plus.webview.getWebviewById("spaceIdx"),"afterAdd",{}),r.fire(plus.webview.getWebviewById("signIdx"),"afterSubmitWork",{}),setTimeout(function(){plus.webview.currentWebview().close()},50)):r.toast(l.ERROR_CONFIG[e.data.SystemCode])},function(e,t,o){console.log("uploaderror"+JSON.stringify(o)),console.log(t),plus.nativeUI.closeWaiting(),r.toast("提交失败，请稍后重试")})};return{init:function(){o=plus.webview.currentWebview().activityId;var e=t();return c.addCirclePhotoBtn.addEventListener("tap",function(){document.activeElement.blur(),console.log("点击添加："+d),i&&plus.nativeUI.actionSheet({cancel:"取消",buttons:[{title:"从相册选择"},{title:"拍照"}]},function(e){if(1==e.index){if(6<=d)return void plus.nativeUI.toast("最多只能选取6张图片");plus.gallery.pick(function(e){for(var t=0;t<e.files.length;t++){var o="_downloads/camera/"+e.files[t].substring(e.files[t].lastIndexOf("/"));l.methodUtil.compressImage(e.files[t],o,function(e){n(e.target),a(!0)},function(){plus.nativeUI.toast("操作失败")},20)}},function(){},{filter:"image",multiple:!0,maximum:6-d,system:!1,onmaxed:function(){0==d?plus.nativeUI.toast("最多只能选取6张图片"):plus.nativeUI.toast("已有"+d+"张图片待上传，最多只能选取"+(6-d)+"张图片")}})}else if(2==e.index){if(6<=d)return void plus.nativeUI.toast("最多只能选取6张图片");l.methodUtil.getCamera(function(e){l.methodUtil.compressImage(e,"_downloads/camera/"+e.substring(e.lastIndexOf("/")),function(e){n(e.target),a(!0)},function(){plus.nativeUI.closeWaiting(),plus.nativeUI.toast("操作失败")},20)})}})}),r("#publishPhotoList").on("tap",".icon-remove",function(){console.log(this.parentNode.className),d--,this.parentNode.remove()}),c.done.addEventListener("tap",function(){document.activeElement.blur(),l.methodUtil.solveSoftKeyboard();var e=c.txt.value,t=c.title.value;console.log(plus.storage.getItem("CPT")+"提交后输出cpt"),""!=t&&""!=e?30<t.length?r.toast("标题不能超过30字"):l.methodUtil.filterEmoji(e)&&l.methodUtil.filterEmoji(t)&&(4e3<e.length?r.toast("作品内容不能超过3000字"):plus.storage.getItem("CPT")&&""!=plus.storage.getItem("CPT")?r.toast("请等待视频上传完成"):r.confirm("是否确认发布，一旦发布不可修改","提示",["确认","取消"],function(e){if(document.activeElement.blur(),console.log(e.index),1!=e.index&&-1!=e.index){console.log("第二步");var i=[],n=[];r(".circle-photo-item").each(function(){i.push(this.getAttribute("src"))});var a=i.length;plus.nativeUI.showWaiting(a?"上传中...":"提交中...");var s=function(t,o){u?t<a?l.methodUtil.uploadImage(i[t],function(e){console.log(i[t]),n.push(e.data.url),s(++t,o)}):o():(n=m,o())};s(0,function(){var e=0<n.length?JSON.stringify(n):"[]",t={content:c.txt.value,title:c.title.value,image:e,activityId:o,video:""};console.log(JSON.stringify(n)),document.querySelector(".video_target")&&(console.log(document.querySelector(".video_target").dataset.target),t.video=l.OSS_URL+plus.storage.getItem("VIDEOFILENAME"),console.log(t.video)),g(t)})}})):r.toast("标题和内容请输入完整")}),e},addOnePhoto:n}}(window,mui);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndvcmsuanMiXSwibmFtZXMiOlsiYWRkV29yayIsImMiLCIkIiwiYWN0aXZpdHlJZCIsInVpIiwiYWRkQ2lyY2xlUGhvdG9CdG4iLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiZG9uZSIsInR4dCIsInRpdGxlIiwiYWRkQ2lyY2xlVmlkZW9CdG4iLCJwYWdlVGl0bGUiLCJxdWVyeVNlbGVjdG9yIiwic2VsZWN0ZWRQaWNOdW0iLCJwaG90b0NoYW5nZWQiLCJpbml0UGhvdG9JbmZvIiwiYWJsZVVwbG9hZCIsImFkZE9uZVBob3RvIiwic3JjIiwidHlwZSIsIm9wdCIsInBob3RvV3JhcCIsIm5ld05vZGUiLCJwaG90b0xpc3RJZCIsImNyZWF0ZUVsZW1lbnQiLCJjb25zb2xlIiwibG9nIiwiY2xhc3NOYW1lIiwiaW5uZXJIVE1MIiwiaW5zZXJ0QmVmb3JlIiwic2VsY3RlZFZpZGVvTnVtIiwic2V0UGhvdG9TdGF0dXMiLCJ2YWwiLCJpbml0UGFnZSIsInZpZGVvTnVtIiwicGx1cyIsInN0b3JhZ2UiLCJnZXRJdGVtIiwiZGF0YSIsIkpTT04iLCJwYXJzZSIsImkiLCJhdHRhY2htZW50IiwibGVuZ3RoIiwicHVzaCIsInZhbHVlIiwiZmlsbFBhZ2UiLCJob21ld29ya0RldGFpbCIsImNvbnRlbnQiLCJzZW5kT2JqIiwic3RyaW5naWZ5IiwibmF0aXZlVUkiLCJzaG93V2FpdGluZyIsImRhdGFVdGlsIiwicmVzIiwiY2xvc2VXYWl0aW5nIiwiU3lzdGVtQ29kZSIsInRvYXN0IiwiZmlyZSIsIndlYnZpZXciLCJjdXJyZW50V2VidmlldyIsIm9wZW5lciIsImdldFdlYnZpZXdCeUlkIiwic2V0VGltZW91dCIsImNsb3NlIiwiRVJST1JfQ09ORklHIiwieGhyIiwiZXJyIiwiaW5pdCIsImFkZEV2ZW50TGlzdGVuZXIiLCJhY3RpdmVFbGVtZW50IiwiYmx1ciIsImFjdGlvblNoZWV0IiwiY2FuY2VsIiwiYnV0dG9ucyIsInNoZWV0RXZlbnQiLCJpbmRleCIsImdhbGxlcnkiLCJwaWNrIiwiZ0V2ZW50IiwiZmlsZXMiLCJkc3QiLCJzdWJzdHJpbmciLCJsYXN0SW5kZXhPZiIsIm1ldGhvZFV0aWwiLCJjb21wcmVzc0ltYWdlIiwiemlwRXZlbnQiLCJ0YXJnZXQiLCJmaWx0ZXIiLCJtdWx0aXBsZSIsIm1heGltdW0iLCJzeXN0ZW0iLCJvbm1heGVkIiwiZ2V0Q2FtZXJhIiwicGF0aCIsIm9uIiwidGhpcyIsInBhcmVudE5vZGUiLCJyZW1vdmUiLCJzb2x2ZVNvZnRLZXlib2FyZCIsInR4dFZhbCIsInRpdGxlVmFsIiwiZmlsdGVyRW1vamkiLCJjb25maXJtIiwiZSIsInBob3RvcyIsInBob3Rvc1BhdGgiLCJlYWNoIiwiZ2V0QXR0cmlidXRlIiwibG9vcCIsImNhbGxCYWNrIiwidXBsb2FkSW1hZ2UiLCJ1cmwiLCJwYXRocyIsImltYWdlIiwidmlkZW8iLCJkYXRhc2V0IiwiT1NTX1VSTCIsIndpbmRvdyIsIm11aSJdLCJtYXBwaW5ncyI6IkFBQUEsSUFBSUEsUUFBVyxTQUFTQyxFQUFHQyxHQUMxQixJQUFJQyxFQUFhLEdBQ2JDLEVBQUssQ0FDUEMsa0JBQW1CQyxTQUFTQyxlQUFlLHFCQUMzQ0MsS0FBTUYsU0FBU0MsZUFBZSxRQUM5QkUsSUFBS0gsU0FBU0MsZUFBZSxhQUM3QkcsTUFBT0osU0FBU0MsZUFBZSxjQUMvQkksa0JBQW1CTCxTQUFTQyxlQUFlLHFCQUMzQ0ssVUFBV04sU0FBU08sY0FBYyxlQUVuQ0MsRUFBaUIsRUFJZEMsR0FBZSxFQUNmQyxFQUFnQixHQUVoQkMsR0FBYSxFQTBCYkMsRUFBYyxTQUFTQyxFQUFLQyxHQXhCWixJQUFTQyxFQUFLRCxFQUM3QkUsRUFDQUMsRUFDQUosRUFId0JFLEVBMkJkLENBQ2JHLFlBRnNCLFVBRHZCSixFQUFPQSxHQUFRLFNBQ2tCLG1CQUFvQixtQkFHcERELElBQUtBLEdBN0IyQkMsRUErQjlCQSxFQTlCQ0UsRUFBWWhCLFNBQVNDLGVBQWVjLEVBQUlHLGFBQ3hDRCxFQUFVakIsU0FBU21CLGNBQWMsTUFD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N0IsUUFBUUMsSUFBSStFLEVBQU9oRSxJQUNuQmlFLEVBQVc5RCxLQUFLVSxFQUFJaEIsS0FBSzBFLEtBR3pCSCxJQURBcEUsRUFDUXFFLEtBSVRBLEtBR0RKLEVBQWEzRixFQUNiK0YsTUFHRkQsRUF4QlEsRUF3QkEsV0FDUCxJQUFJSSxFQUE0QixFQUFwQlAsRUFBVy9ELE9BQWFKLEtBQUtXLFVBQVV3RCxHQUFjLEtBQzdEekQsRUFBVSxDQUNiRCxRQUFTN0MsRUFBR0ssSUFBSXFDLE1BQ2hCcEMsTUFBT04sRUFBR00sTUFBTW9DLE1BQ2hCcUUsTUFBT0QsRUFDUC9HLFdBQVlBLEVBQ1ppSCxNQUFPLElBRVIxRixRQUFRQyxJQUFJYSxLQUFLVyxVQUFVd0QsSUFDeEJyRyxTQUFTTyxjQUFjLG1CQUN6QmEsUUFBUUMsSUFBSXJCLFNBQVNPLGNBQWMsaUJBQWlCd0csUUFBUTdCLFFBVTVEdEMsRUFBUWtFLE1BQU9uSCxFQUFFcUgsUUFBUWxGLEtBQUtDLFFBQVFDLFFBQVEsaUJBQzlDWixRQUFRQyxJQUFJdUIsRUFBUWtFLFFBQ3BCcEgsRUFBUWtELFNBM0VYaEQsRUFBRXdELE1BQU0sZ0JBNEZGdkIsR0FFUmpCLFlBQVlBLEdBMVdBLENBNFdacUcsT0FBUUMiLCJmaWxlIjoid29yay5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBhZGRXb3JrID0gKGZ1bmN0aW9uKGMsICQpIHtcclxuXHR2YXIgYWN0aXZpdHlJZCA9ICcnO1xyXG5cdHZhciB1aSA9IHtcclxuXHRcdFx0YWRkQ2lyY2xlUGhvdG9CdG46IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYWRkQ2lyY2xlUGhvdG9CdG5cIiksXHJcblx0XHRcdGRvbmU6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZG9uZVwiKSxcclxuXHRcdFx0dHh0OiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIndvcmstdGV4dFwiKSxcclxuXHRcdFx0dGl0bGU6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwid29yay10aXRsZVwiKSxcclxuXHRcdFx0YWRkQ2lyY2xlVmlkZW9CdG46IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYWRkQ2lyY2xlVmlkZW9CdG5cIiksXHJcblx0XHRcdHBhZ2VUaXRsZTogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm11aS10aXRsZScpLFxyXG5cdFx0fSxcclxuXHRcdHNlbGVjdGVkUGljTnVtID0gMCwgLy/lt7Lnu4/pgInmi6nnmoTlm77niYfmlbBcclxuXHRcdHNlbGN0ZWRWaWRlb051bSA9IDA7IC8v5bey6YCJ5oup55qE6KeG6aKR5pWwXHJcblx0dmFyIG1heE51bSA9IDYsXHJcblx0XHR2aWRlb01heE51bSA9IDE7XHJcblx0dmFyIHBob3RvQ2hhbmdlZCA9IGZhbHNlO1xyXG5cdHZhciBpbml0UGhvdG9JbmZvID0gW107XHJcblx0dmFyIHBob3RvTGlzdElkID0gXCJwdWJsaXNoUGhvdG9MaXN0XCI7XHJcblx0dmFyIGFibGVVcGxvYWQgPSB0cnVlO1xyXG5cclxuXHR2YXIgY3JlYXRlUHJldmlldyA9IGZ1bmN0aW9uKG9wdCwgdHlwZSkge1xyXG5cdFx0dmFyIHBob3RvV3JhcCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG9wdC5waG90b0xpc3RJZCk7XHJcblx0XHR2YXIgbmV3Tm9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJsaVwiKTtcclxuXHRcdHZhciBzcmMgPSBvcHQuc3JjO1xyXG5cdFx0Y29uc29sZS5sb2coJzExMTExJyArIHR5cGUpXHJcblx0XHRpZih0eXBlID09ICd2aWRlbycpIHtcclxuXHRcdFx0bmV3Tm9kZS5jbGFzc05hbWUgPSAndmlkZW9fbGknO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmKHNyYyAmJiB0eXBlID09ICdpbWFnZScpIHtcclxuXHRcdFx0bmV3Tm9kZS5pbm5lckhUTUwgPSAnPGltZyBjbGFzcz1cImljb24tcmVtb3ZlXCIgc3JjPVwiLi4vLi4vYXNzZXRzL2ltYWdlcy9zcXVhZHJvbi9jYW5jZWwucG5nXCIgLz48aW1nIGNsYXNzPVwiY2lyY2xlLXBob3RvLWl0ZW1cIiBzcmM9XCInICtcclxuXHRcdFx0XHRzcmMgKyAnXCIvPic7XHJcblxyXG5cdFx0XHRwaG90b1dyYXAuaW5zZXJ0QmVmb3JlKG5ld05vZGUsIHVpLmFkZENpcmNsZVBob3RvQnRuKTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdG5ld05vZGUuaW5uZXJIVE1MID0gJzxpbWcgY2xhc3M9XCJpY29uLXJlbW92ZSBpY29uLXJlbW92ZS12aWRlb1wiIHNyYz1cIi4uLy4uL2Fzc2V0cy9pbWFnZXMvc3F1YWRyb24vY2FuY2VsLnBuZ1wiIC8+PGRpdiBjbGFzcz1cInZpZGVvX3RhcmdldFwiIGRhdGEtdGFyZ2V0PVwiJyArIHNyYyArICdcIj48aW1nIGNsYXNzPVwidmlkZW8taXRlbVwiIHNyYz1cIi4uLy4uL2Fzc2V0cy9pbWFnZXMvc3BhY2UvcGxheS5wbmdcIi8+PC9kaXY+JztcclxuXHRcdFx0cGhvdG9XcmFwLmluc2VydEJlZm9yZShuZXdOb2RlLCB1aS5hZGRDaXJjbGVWaWRlb0J0bik7XHJcblx0XHR9XHJcblxyXG5cdH07XHJcblx0LyogdmFyIG9uTnVtQ2hhbmdlID0gZnVuY3Rpb24oKXtcclxuXHJcblx0IFx0dWkuYWRkQ2lyY2xlUGhvdG9CdG4uc3R5bGUuZGlzcGxheSA9IHNlbGVjdGVkUGljTnVtPj1tYXhOdW0gPyAnbm9uZSc6Jyc7XHJcblx0IH07Ki9cclxuXHR2YXIgYWRkT25lUGhvdG8gPSBmdW5jdGlvbihzcmMsIHR5cGUpIHtcclxuXHRcdHR5cGUgPSB0eXBlIHx8ICdpbWFnZSc7XHJcblx0XHRwaG90b0xpc3RJZCA9ICh0eXBlID09IFwidmlkZW9cIik/IFwicHVibGlzaFZpZGVvTGlzdFwiIDpcInB1Ymxpc2hQaG90b0xpc3RcIjtcclxuXHRcdGNyZWF0ZVByZXZpZXcoe1xyXG5cdFx0XHRwaG90b0xpc3RJZDogcGhvdG9MaXN0SWQsXHJcblx0XHRcdHNyYzogc3JjXHJcblxyXG5cdFx0fSwgdHlwZSk7XHJcblx0XHR0eXBlID09ICdpbWFnZScgPyBzZWxlY3RlZFBpY051bSsrIDogc2VsY3RlZFZpZGVvTnVtKytcclxuXHJcblx0fTtcclxuXHR2YXIgc2V0UGhvdG9TdGF0dXMgPSBmdW5jdGlvbih2YWwpIHtcclxuXHRcdHBob3RvQ2hhbmdlZCA9IHZhbDtcclxuXHR9O1xyXG5cclxuXHR2YXIgZmlsbFBhZ2UgPSBmdW5jdGlvbihkYXRhKSB7XHJcblx0XHR1aS50eHQudmFsdWUgPSBkYXRhLnR4dDtcclxuXHRcdHVpLnRpdGxlLnZhbHVlID0gZGF0YS50aXRsZTtcclxuXHRcdGZvcih2YXIgaT0wO2k8ZGF0YS5zcmMubGVuZ3RoO2krKyl7XHJcblx0XHRcdGFkZE9uZVBob3RvKGRhdGEuc3JjW2ldKTtcclxuXHRcdH1cclxuXHR9O1xyXG5cclxuXHR2YXIgaW5pdFBhZ2UgPSBmdW5jdGlvbigpIHtcclxuXHRcdHZhciB2aWRlb051bT0wXHJcblx0XHRhYmxlVXBsb2FkID0gdHJ1ZTtcclxuXHRcdGlmKHBsdXMuc3RvcmFnZS5nZXRJdGVtKCdIT01FV09SSycpJiZwbHVzLnN0b3JhZ2UuZ2V0SXRlbSgnSE9NRVdPUksnKSE9Jycpe1xyXG5cdFx0XHR2YXIgZGF0YT0gSlNPTi5wYXJzZShwbHVzLnN0b3JhZ2UuZ2V0SXRlbSgnSE9NRVdPUksnKSk7XHJcblx0XHRcdGZvcih2YXIgaT0wO2k8ZGF0YS5hdHRhY2htZW50Lmxlbmd0aDtpKyspe1xyXG5cdFx0XHRcdGlmKGRhdGEuYXR0YWNobWVudFtpXS50eXBlPT0naW1hZ2UnKXtcclxuXHRcdFx0XHRcdGluaXRQaG90b0luZm8ucHVzaChkYXRhLmF0dGFjaG1lbnRbaV0uYXR0YWNobWVudCk7XHJcblx0XHRcdFx0fWVsc2UgaWYoZGF0YS5hdHRhY2htZW50W2ldLnR5cGU9PSd2aWRlbycpe1xyXG5cdFx0XHRcdFx0YWRkT25lUGhvdG8oZGF0YS5hdHRhY2htZW50W2ldLmF0dGFjaG1lbnQsICd2aWRlbycpO1xyXG5cdFx0XHRcdFx0dmlkZW9OdW09MTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdHZhciBzcmMgPVxyXG5cdFx0XHRcdGZpbGxQYWdlKHtcclxuXHRcdFx0XHRcdHR4dDogZGF0YS5ob21ld29ya0RldGFpbC5jb250ZW50IHx8ICcnLFxyXG5cdFx0XHRcdFx0dGl0bGU6IGRhdGEuaG9tZXdvcmtEZXRhaWwudGl0bGUgfHwgJycsXHJcblx0XHRcdFx0XHRzcmM6IGluaXRQaG90b0luZm9cclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0cmV0dXJuIHZpZGVvTnVtO1xyXG5cdFx0fVxyXG5cdH07XHJcblxyXG5cdHZhciBhZGRXb3JrID0gZnVuY3Rpb24oc2VuZE9iaikge1xyXG5cdFx0Y29uc29sZS5sb2coXCLkuIrkvKDkvZzkuJrlj4LmlbDvvJpcIiArIEpTT04uc3RyaW5naWZ5KHNlbmRPYmopKTtcclxuXHRcdHBsdXMubmF0aXZlVUkuc2hvd1dhaXRpbmcoJ+WPkeW4g+S4rS4uLicpO1xyXG5cdFx0Yy5kYXRhVXRpbC5hZGRXb3JrKHNlbmRPYmosIGZ1bmN0aW9uKHJlcykge1xyXG5cdFx0XHRwbHVzLm5hdGl2ZVVJLmNsb3NlV2FpdGluZygpO1xyXG5cdFx0XHRjb25zb2xlLmxvZygnPT095paw5aKe5L2c5LiaPT09JyArIEpTT04uc3RyaW5naWZ5KHJlcykpO1xyXG5cdFx0XHRyZXMgPSByZXMgfHwge307XHJcblx0XHRcdHJlcy5kYXRhID0gcmVzLmRhdGEgfHwge307XHJcblx0XHRcdGlmKHJlcy5kYXRhLlN5c3RlbUNvZGUgPT0gMSkge1xyXG5cdFx0XHRcdCQudG9hc3QoJ+aPkOS6pOaIkOWKnycpO1xyXG5cdFx0XHRcdCQuZmlyZShwbHVzLndlYnZpZXcuY3VycmVudFdlYnZpZXcoKS5vcGVuZXIoKSwgJ2FkZFN1Y2Nlc3MnLCB7fSk7XHJcblx0XHRcdFx0JC5maXJlKHBsdXMud2Vidmlldy5nZXRXZWJ2aWV3QnlJZCgnc3F1YWRyb25JZHgnKSwgJ2FmdGVyQWRkJywge30pO1xyXG5cdFx0XHRcdCQuZmlyZShwbHVzLndlYnZpZXcuZ2V0V2Vidmlld0J5SWQoJ3NwYWNlSWR4JyksICdhZnRlckFkZCcsIHt9KTtcclxuXHRcdFx0XHQkLmZpcmUocGx1cy53ZWJ2aWV3LmdldFdlYnZpZXdCeUlkKCdzaWduSWR4JyksJ2FmdGVyU3VibWl0V29yaycsIHt9KTtcclxuXHRcdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0cGx1cy53ZWJ2aWV3LmN1cnJlbnRXZWJ2aWV3KCkuY2xvc2UoKTsgLy/lhbPpl63pobXpnaJcclxuXHRcdFx0XHR9LCA1MCk7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0JC50b2FzdChjLkVSUk9SX0NPTkZJR1tyZXMuZGF0YS5TeXN0ZW1Db2RlXSk7XHJcblx0XHRcdH1cclxuXHRcdH0sIGZ1bmN0aW9uKHhociwgdHlwZSwgZXJyKSB7XHJcblx0XHRcdGNvbnNvbGUubG9nKFwidXBsb2FkZXJyb3JcIiArIEpTT04uc3RyaW5naWZ5KGVycikpO1xyXG5cdFx0XHRjb25zb2xlLmxvZyh0eXBlKTtcclxuXHRcdFx0cGx1cy5uYXRpdmVVSS5jbG9zZVdhaXRpbmcoKTtcclxuXHRcdFx0JC50b2FzdCgn5o+Q5Lqk5aSx6LSl77yM6K+356iN5ZCO6YeN6K+VJylcclxuXHRcdH0pXHJcblx0fVxyXG5cclxuXHQvL+S6i+S7tue7keWumiBcclxuXHRmdW5jdGlvbiBiaW5kRXZlbnRzKCkge1xyXG5cclxuXHRcdC8v54K55Ye75LiK5Lyg5Zu+54mHXHJcblx0XHR1aS5hZGRDaXJjbGVQaG90b0J0bi5hZGRFdmVudExpc3RlbmVyKCd0YXAnLCBmdW5jdGlvbigpIHtcclxuXHRcdFx0ZG9jdW1lbnQuYWN0aXZlRWxlbWVudC5ibHVyKCk7XHJcblx0XHRcdGNvbnNvbGUubG9nKFwi54K55Ye75re75Yqg77yaXCIgKyBzZWxlY3RlZFBpY051bSk7XHJcblx0XHRcdGlmKCFhYmxlVXBsb2FkKSByZXR1cm47XHJcblxyXG5cdFx0XHRwbHVzLm5hdGl2ZVVJLmFjdGlvblNoZWV0KHtcclxuXHRcdFx0XHRjYW5jZWw6IFwi5Y+W5raIXCIsXHJcblx0XHRcdFx0YnV0dG9uczogW3tcclxuXHRcdFx0XHRcdFx0dGl0bGU6IFwi5LuO55u45YaM6YCJ5oupXCJcclxuXHRcdFx0XHRcdH0sXHJcblx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdHRpdGxlOiBcIuaLjeeFp1wiXHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XVxyXG5cdFx0XHR9LCBmdW5jdGlvbihzaGVldEV2ZW50KSB7IC8vIOiwiOWHuuahhumAieaLqeWQjuWbnuiwg1xyXG5cdFx0XHRcdGlmKHNoZWV0RXZlbnQuaW5kZXggPT0gMSkgeyAvL+S7juebuOWGjOmAieaLqVxyXG5cdFx0XHRcdFx0aWYoc2VsZWN0ZWRQaWNOdW0gPj0gbWF4TnVtKSB7XHJcblx0XHRcdFx0XHRcdHBsdXMubmF0aXZlVUkudG9hc3QoJ+acgOWkmuWPquiDvemAieWPlicgKyBtYXhOdW0gKyAn5byg5Zu+54mHJyk7XHJcblx0XHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdHBsdXMuZ2FsbGVyeS5waWNrKGZ1bmN0aW9uKGdFdmVudCkge1xyXG5cdFx0XHRcdFx0XHRmb3IodmFyIGkgPSAwOyBpIDwgZ0V2ZW50LmZpbGVzLmxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdFx0XHRcdFx0dmFyIGRzdCA9IFwiX2Rvd25sb2Fkcy9jYW1lcmEvXCIgKyBnRXZlbnQuZmlsZXNbaV0uc3Vic3RyaW5nKGdFdmVudC5maWxlc1tpXS5sYXN0SW5kZXhPZignLycpKTtcclxuXHRcdFx0XHRcdFx0XHRjLm1ldGhvZFV0aWwuY29tcHJlc3NJbWFnZShnRXZlbnQuZmlsZXNbaV0sIGRzdCwgZnVuY3Rpb24oemlwRXZlbnQpIHtcclxuXHRcdFx0XHRcdFx0XHRcdGFkZE9uZVBob3RvKHppcEV2ZW50LnRhcmdldCk7XHJcblx0XHRcdFx0XHRcdFx0XHRzZXRQaG90b1N0YXR1cyh0cnVlKTtcclxuXHJcblx0XHRcdFx0XHRcdFx0fSwgZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRwbHVzLm5hdGl2ZVVJLnRvYXN0KFwi5pON5L2c5aSx6LSlXCIpO1xyXG5cdFx0XHRcdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdFx0XHRcdH0sIDIwKVxyXG5cdFx0XHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdFx0fSwgZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHRcdH0sIHtcclxuXHRcdFx0XHRcdFx0ZmlsdGVyOiAnaW1hZ2UnLFxyXG5cdFx0XHRcdFx0XHRtdWx0aXBsZTogdHJ1ZSxcclxuXHRcdFx0XHRcdFx0bWF4aW11bTogKG1heE51bSAtIHNlbGVjdGVkUGljTnVtKSxcclxuXHRcdFx0XHRcdFx0c3lzdGVtOiBmYWxzZSxcclxuXHRcdFx0XHRcdFx0b25tYXhlZDogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdFx0aWYoc2VsZWN0ZWRQaWNOdW0gPT0gMCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0cGx1cy5uYXRpdmVVSS50b2FzdCgn5pyA5aSa5Y+q6IO96YCJ5Y+WJyArIG1heE51bSArICflvKDlm77niYcnKTtcclxuXHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdFx0cGx1cy5uYXRpdmVVSS50b2FzdCgn5bey5pyJJyArIHNlbGVjdGVkUGljTnVtICsgJ+W8oOWbvueJh+W+heS4iuS8oO+8jOacgOWkmuWPquiDvemAieWPlicgKyAobWF4TnVtIC0gc2VsZWN0ZWRQaWNOdW0pICsgJ+W8oOWbvueJhycpO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSk7XHJcblxyXG5cdFx0XHRcdH0gZWxzZSBpZihzaGVldEV2ZW50LmluZGV4ID09IDIpIHsgLy/mi43nhadcclxuXHRcdFx0XHRcdGlmKHNlbGVjdGVkUGljTnVtID49IG1heE51bSkge1xyXG5cdFx0XHRcdFx0XHRwbHVzLm5hdGl2ZVVJLnRvYXN0KCfmnIDlpJrlj6rog73pgInlj5YnICsgbWF4TnVtICsgJ+W8oOWbvueJhycpO1xyXG5cdFx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRjLm1ldGhvZFV0aWwuZ2V0Q2FtZXJhKGZ1bmN0aW9uKHBhdGgpIHtcclxuXHRcdFx0XHRcdFx0Yy5tZXRob2RVdGlsLmNvbXByZXNzSW1hZ2UocGF0aCwgXCJfZG93bmxvYWRzL2NhbWVyYS9cIiArIHBhdGguc3Vic3RyaW5nKHBhdGgubGFzdEluZGV4T2YoJy8nKSksIGZ1bmN0aW9uKHppcEV2ZW50KSB7XHJcblxyXG5cdFx0XHRcdFx0XHRcdGFkZE9uZVBob3RvKHppcEV2ZW50LnRhcmdldCk7XHJcblx0XHRcdFx0XHRcdFx0c2V0UGhvdG9TdGF0dXModHJ1ZSk7XHJcblx0XHRcdFx0XHRcdH0sIGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0XHRcdHBsdXMubmF0aXZlVUkuY2xvc2VXYWl0aW5nKCk7XHJcblx0XHRcdFx0XHRcdFx0cGx1cy5uYXRpdmVVSS50b2FzdChcIuaTjeS9nOWksei0pVwiKTtcclxuXHRcdFx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0XHRcdH0sIDIwKVxyXG5cdFx0XHRcdFx0fSk7XHJcblxyXG5cdFx0XHRcdH0gXHJcblx0XHRcdH0pO1xyXG5cdFx0fSk7XHJcblx0XHRcclxuXHRcdC8v5LiK5Lyg6KeG6aKR5pawXHJcbi8vXHRcdGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd2aWRlb1VwbG9hZElucHV0JykuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJyxmdW5jdGlvbigpe1xyXG4vL1x0XHRcdGNvbnNvbGUubG9nKHRoaXMuZmlsZXNbMF0pO1xyXG4vL1x0XHR9KVxyXG5cdFx0XHJcblx0XHQvL+eCueWHu+S4iuS8oOinhumikVxyXG4vL1x0XHR1aS5hZGRDaXJjbGVWaWRlb0J0bi5hZGRFdmVudExpc3RlbmVyKCd0YXAnLGZ1bmN0aW9uKCl7XHJcbi8vXHRcdFx0ZG9jdW1lbnQuYWN0aXZlRWxlbWVudC5ibHVyKCk7XHJcbi8vXHRcdFx0Y29uc29sZS5sb2coXCLngrnlh7vmt7vliqDvvJpcIiArIHNlbGN0ZWRWaWRlb051bSk7XHJcbi8vXHRcdFx0aWYoIWFibGVVcGxvYWQpIHJldHVybjtcclxuLy9cdFx0XHRcclxuLy9cdFx0XHRpZihzZWxjdGVkVmlkZW9OdW0gPj0gdmlkZW9NYXhOdW0pIHtcclxuLy9cdFx0XHRcdHBsdXMubmF0aXZlVUkudG9hc3QoJ+acgOWkmuWPquiDvemAieWPlicgKyB2aWRlb01heE51bSArICfkuKrop4bpopEnKTtcclxuLy9cdFx0XHRcdHJldHVybjtcclxuLy9cdFx0XHR9XHJcbi8vXHRcdFx0cGx1cy5nYWxsZXJ5LnBpY2soZnVuY3Rpb24oZSkge1xyXG4vL1x0XHRcdFx0cGx1cy5pby5yZXNvbHZlTG9jYWxGaWxlU3lzdGVtVVJMKGUsIGZ1bmN0aW9uKGVudHJ5KSB7XHJcbi8vXHRcdFx0XHRcdGVudHJ5LmZpbGUoZnVuY3Rpb24oZmlsZSkge1xyXG4vL1x0XHRcdFx0XHRcdGNvbnNvbGUubG9nKCdmaWxlPScgKyBKU09OLnN0cmluZ2lmeShmaWxlKSlcclxuLy9cdFx0XHRcdFx0XHRjb25zb2xlLmxvZyhmaWxlLnNpemUgKyAnLS0nICsgZmlsZS5uYW1lKTtcclxuLy9cdFx0XHRcdFx0XHQvL+WIpOaWreaWh+S7tuWkp+Wwj1xyXG4vL1x0XHRcdFx0XHRcdHZhciBsaW1pdFNpemUgPSAxMDAgKiAxMDI0ICogMTAyNDtcclxuLy9cdFx0XHRcdFx0XHRpZihsaW1pdFNpemUgPD0gZmlsZS5zaXplKSB7XHJcbi8vXHRcdFx0XHRcdFx0XHQkLnRvYXN0KCfop4bpopHlpKrlpKfllaYnKTtcclxuLy9cdFx0XHRcdFx0XHRcdHBsdXMuemlwLmNvbXByZXNzKGZpbGUuZnVsbFBhdGgsICcvc3RvcmFnZS9lbXVsYXRlZC8wL0RDSU0vQ2FtZXJhLycsIGZ1bmN0aW9uKHppcEV2ZW50KSB7XHJcbi8vXHRcdFx0XHRcdFx0XHRcdGNvbnNvbGUubG9nKHppcEV2ZW50KTtcclxuLy9cdFx0XHRcdFx0XHRcdFx0YWRkT25lUGhvdG8oemlwRXZlbnQudGFyZ2V0KTtcclxuLy9cclxuLy9cdFx0XHRcdFx0XHRcdH0sIGZ1bmN0aW9uKCkge1xyXG4vL1x0XHRcdFx0XHRcdFx0XHRwbHVzLm5hdGl2ZVVJLnRvYXN0KFwi5pON5L2c5aSx6LSlXCIpO1xyXG4vL1x0XHRcdFx0XHRcdFx0XHRyZXR1cm47XHJcbi8vXHRcdFx0XHRcdFx0XHR9KTtcclxuLy9cdFx0XHRcdFx0XHR9ZWxzZXtcclxuLy9cdFx0XHRcdFx0XHRcdGFkZE9uZVBob3RvKCdmaWxlOi8vJyArIGZpbGUuZnVsbFBhdGgsICd2aWRlbycpO1xyXG4vL1x0XHRcdFx0XHRcdH1cclxuLy9cdFx0XHRcdFx0XHRcclxuLy9cclxuLy9cdFx0XHRcdFx0fSk7XHJcbi8vXHRcdFx0XHR9LCBmdW5jdGlvbihlcnJvcikge1xyXG4vL1x0XHRcdFx0XHRjb25zb2xlLmxvZyhcIlJlcXVlc3QgZmlsZSBzeXN0ZW0gZmFpbGVkOlwiICsgZXJyb3IubWVzc2FnZSk7XHJcbi8vXHRcdFx0XHR9KVxyXG4vL1xyXG4vL1x0XHRcdH0sIGZ1bmN0aW9uKCkge1xyXG4vL1x0XHRcdFx0cmV0dXJuO1xyXG4vL1x0XHRcdH0sIHtcclxuLy9cdFx0XHRcdGZpbHRlcjogJ3ZpZGVvJyxcclxuLy9cdFx0XHRcdG11bHRpcGxlOiBmYWxzZSxcclxuLy9cdFx0XHRcdG1heGltdW06ICh2aWRlb01heE51bSAtIHNlbGN0ZWRWaWRlb051bSksXHJcbi8vXHRcdFx0XHRzeXN0ZW06IGZhbHNlLFxyXG4vL1x0XHRcdFx0b25tYXhlZDogZnVuY3Rpb24oKSB7XHJcbi8vXHRcdFx0XHRcdGlmKHNlbGVjdGVkUGljTnVtID09IDApIHtcclxuLy9cdFx0XHRcdFx0XHRwbHVzLm5hdGl2ZVVJLnRvYXN0KCfmnIDlpJrlj6rog73pgInlj5YnICsgc2VsY3RlZFZpZGVvTnVtICsgJ+S4quinhumikScpO1xyXG4vL1x0XHRcdFx0XHR9IGVsc2Uge1xyXG4vL1x0XHRcdFx0XHRcdHBsdXMubmF0aXZlVUkudG9hc3QoJ+W3suaciScgKyBzZWxjdGVkVmlkZW9OdW0gKyAn5Liq6KeG6aKR5b6F5LiK5Lyg77yM5pyA5aSa5Y+q6IO96YCJ5Y+WJyArICh2aWRlb01heE51bSAtIHNlbGN0ZWRWaWRlb051bSkgKyAn5Liq6KeG6aKRJyk7XHJcbi8vXHRcdFx0XHRcdH1cclxuLy9cdFx0XHRcdH1cclxuLy9cdFx0XHR9KTtcclxuLy9cdFx0fSlcclxuLy9cdFx0XHJcblx0XHQvL+WIoOmZpOWbvueJh1xyXG5cdFx0JChcIiNwdWJsaXNoUGhvdG9MaXN0XCIpLm9uKCd0YXAnLCAnLmljb24tcmVtb3ZlJywgZnVuY3Rpb24oKSB7XHJcblx0XHRcdGNvbnNvbGUubG9nKHRoaXMucGFyZW50Tm9kZS5jbGFzc05hbWUpO1xyXG5cdFx0XHRzZWxlY3RlZFBpY051bS0tO1xyXG5cdFx0XHR0aGlzLnBhcmVudE5vZGUucmVtb3ZlKCk7XHJcblx0XHR9KTtcclxuXHRcdFxyXG5cdFxyXG5cclxuXHRcdC8v5Y+R6KGo5L2c5LiaXHJcblx0XHR1aS5kb25lLmFkZEV2ZW50TGlzdGVuZXIoJ3RhcCcsIGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRkb2N1bWVudC5hY3RpdmVFbGVtZW50LmJsdXIoKTtcclxuXHRcdFx0Yy5tZXRob2RVdGlsLnNvbHZlU29mdEtleWJvYXJkKCk7XHJcblx0XHRcdHZhciB0eHRWYWwgPSB1aS50eHQudmFsdWU7XHJcblx0XHRcdHZhciB0aXRsZVZhbCA9IHVpLnRpdGxlLnZhbHVlO1xyXG5cdFx0XHRjb25zb2xlLmxvZyhwbHVzLnN0b3JhZ2UuZ2V0SXRlbSgnQ1BUJykrJ+aPkOS6pOWQjui+k+WHumNwdCcpXHJcblx0XHRcdGlmKHRpdGxlVmFsID09IFwiXCIgfHwgdHh0VmFsID09IFwiXCIpIHtcclxuXHRcdFx0XHQkLnRvYXN0KFwi5qCH6aKY5ZKM5YaF5a656K+36L6T5YWl5a6M5pW0XCIpO1xyXG5cdFx0XHRcdHJldHVybjtcclxuXHRcdFx0fSBlbHNlIGlmKHRpdGxlVmFsLmxlbmd0aCA+IDMwKSB7XHJcblx0XHRcdFx0JC50b2FzdChcIuagh+mimOS4jeiDvei2hei/hzMw5a2XXCIpO1xyXG5cdFx0XHRcdHJldHVybjtcclxuXHRcdFx0fSBlbHNlIGlmKCFjLm1ldGhvZFV0aWwuZmlsdGVyRW1vamkodHh0VmFsKSB8fCAhYy5tZXRob2RVdGlsLmZpbHRlckVtb2ppKHRpdGxlVmFsKSkgeyAvL+aciWVtb2pp6KGo5oOFXHJcblx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHR9IGVsc2UgaWYodHh0VmFsLmxlbmd0aCA+IDQwMDApIHtcclxuXHRcdFx0XHQkLnRvYXN0KFwi5L2c5ZOB5YaF5a655LiN6IO96LaF6L+HMzAwMOWtl1wiKTtcclxuXHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdH0gZWxzZSBpZihwbHVzLnN0b3JhZ2UuZ2V0SXRlbSgnQ1BUJykmJnBsdXMuc3RvcmFnZS5nZXRJdGVtKCdDUFQnKSE9Jycpe1xyXG5cdFx0XHRcdCQudG9hc3QoXCLor7fnrYnlvoXop4bpopHkuIrkvKDlrozmiJBcIik7XHJcblx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHR9XHJcblx0XHRcdC8v6aqM6K+B6YCa6L+HXHJcblx0XHRcdCQuY29uZmlybSgn5piv5ZCm56Gu6K6k5Y+R5biD77yM5LiA5pem5Y+R5biD5LiN5Y+v5L+u5pS5JywgJ+aPkOekuicsIFsn56Gu6K6kJywgJ+WPlua2iCddLCBmdW5jdGlvbihlKSB7XHJcblx0XHRcdFx0ZG9jdW1lbnQuYWN0aXZlRWxlbWVudC5ibHVyKCk7IC8v5pS25Zue6L2v6ZSu55uYXHJcblx0XHRcdFx0Y29uc29sZS5sb2coZS5pbmRleCk7XHJcblx0XHRcdFx0aWYoZS5pbmRleCA9PSAxIHx8IGUuaW5kZXggPT0gLTEpIHtcclxuXHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0Y29uc29sZS5sb2coXCLnrKzkuozmraVcIik7XHJcblx0XHRcdFx0XHQvL1x0XHRcdFx0XHRwbHVzLm5hdGl2ZVVJLnNob3dXYWl0aW5nKCflj5HluIPkuK0uLi4nKTtcclxuXHRcdFx0XHRcdHZhciBwaG90b3MgPSBbXTsgLy/kuIrkvKDlm77niYflnLDlnYBcclxuXHRcdFx0XHRcdHZhciBwaG90b3NQYXRoID0gW107IC8v6L+U5Zue5Zu+54mH5Zyw5Z2AXHJcblx0XHRcdFx0XHQkKCcuY2lyY2xlLXBob3RvLWl0ZW0nKS5lYWNoKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0XHRwaG90b3MucHVzaCh0aGlzLmdldEF0dHJpYnV0ZSgnc3JjJykpO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHR2YXIgaSA9IDA7XHJcblx0XHRcdFx0XHR2YXIgbGVuZ3RoID0gcGhvdG9zLmxlbmd0aDtcclxuXHRcdFx0XHRcdHBsdXMubmF0aXZlVUkuc2hvd1dhaXRpbmcobGVuZ3RoID8gJ+S4iuS8oOS4rS4uLicgOiAn5o+Q5Lqk5LitLi4uJyk7XHJcblx0XHRcdFx0XHQvL+mAkuW9kuS4iuS8oOWbvueJh1xyXG5cdFx0XHRcdFx0dmFyIGxvb3AgPSBmdW5jdGlvbihpLCBjYWxsQmFjaykge1xyXG5cdFx0XHRcdFx0XHRpZihwaG90b0NoYW5nZWQpIHtcclxuXHRcdFx0XHRcdFx0XHRpZihpIDwgbGVuZ3RoKSB7XHJcblxyXG5cdFx0XHRcdFx0XHRcdFx0Yy5tZXRob2RVdGlsLnVwbG9hZEltYWdlKHBob3Rvc1tpXSwgZnVuY3Rpb24ocmVzKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGNvbnNvbGUubG9nKHBob3Rvc1tpXSk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHBob3Rvc1BhdGgucHVzaChyZXMuZGF0YS51cmwpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHQvL1x0XHRcdFx0XHRcdFx0XHRcdGNvbnNvbGUubG9nKEpTT04uc3RyaW5naWZ5KHJlcykpXHJcblx0XHRcdFx0XHRcdFx0XHRcdGkrKztcclxuXHRcdFx0XHRcdFx0XHRcdFx0bG9vcChpLCBjYWxsQmFjayk7XHJcblx0XHRcdFx0XHRcdFx0XHR9KTtcclxuXHJcblx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRcdGNhbGxCYWNrKCk7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdHBob3Rvc1BhdGggPSBpbml0UGhvdG9JbmZvO1xyXG5cdFx0XHRcdFx0XHRcdGNhbGxCYWNrKCk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH07XHJcblx0XHRcdFx0XHRsb29wKGksIGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0XHR2YXIgcGF0aHMgPSBwaG90b3NQYXRoLmxlbmd0aCA+IDAgPyBKU09OLnN0cmluZ2lmeShwaG90b3NQYXRoKSA6IFwiW11cIjsgLy/lm77niYfot6/lvoRcclxuXHRcdFx0XHRcdFx0dmFyIHNlbmRPYmogPSB7XHJcblx0XHRcdFx0XHRcdFx0Y29udGVudDogdWkudHh0LnZhbHVlLFxyXG5cdFx0XHRcdFx0XHRcdHRpdGxlOiB1aS50aXRsZS52YWx1ZSxcclxuXHRcdFx0XHRcdFx0XHRpbWFnZTogcGF0aHMsXHJcblx0XHRcdFx0XHRcdFx0YWN0aXZpdHlJZDogYWN0aXZpdHlJZCxcclxuXHRcdFx0XHRcdFx0XHR2aWRlbzogJydcclxuXHRcdFx0XHRcdFx0fTsgLy/kvKDnu5nlkI7lj7DnmoTlj4LmlbBcclxuXHRcdFx0XHRcdFx0Y29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkocGhvdG9zUGF0aCkpO1xyXG5cdFx0XHRcdFx0XHRpZihkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnZpZGVvX3RhcmdldFwiKSkgeyAvL+acieinhumikVxyXG5cdFx0XHRcdFx0XHRcdGNvbnNvbGUubG9nKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudmlkZW9fdGFyZ2V0XCIpLmRhdGFzZXQudGFyZ2V0KTtcclxuLy9cdFx0XHRcdFx0XHRcdGMubWV0aG9kVXRpbC51cGxvYWRWaWRlbyhkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnZpZGVvX3RhcmdldFwiKS5kYXRhc2V0LnRhcmdldCwgZnVuY3Rpb24ocmVzKSB7XHJcbi8vXHRcdFx0XHRcdFx0XHRcdGNvbnNvbGUubG9nKCc9PT3op4bpopHkuIrkvKA9PT0nICsgSlNPTi5zdHJpbmdpZnkocmVzKSk7XHJcbi8vXHRcdFx0XHRcdFx0XHRcdGlmKHJlcy5TeXN0ZW1Db2RlID09IDEpIHtcclxuLy9cdFx0XHRcdFx0XHRcdFx0XHRzZW5kT2JqLnZpZGVvID0gcmVzLmRhdGEudXJsO1xyXG4vL1x0XHRcdFx0XHRcdFx0XHRcdGFkZFdvcmsoc2VuZE9iaik7XHJcbi8vXHRcdFx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcbi8vXHJcbi8vXHRcdFx0XHRcdFx0XHRcdH1cclxuLy9cdFx0XHRcdFx0XHRcdH0pXHJcblx0XHRcdFx0XHRcdFx0c2VuZE9iai52aWRlbyA9Yy5PU1NfVVJMK3BsdXMuc3RvcmFnZS5nZXRJdGVtKCdWSURFT0ZJTEVOQU1FJyk7XHJcblx0XHRcdFx0XHRcdFx0Y29uc29sZS5sb2coc2VuZE9iai52aWRlbyk7XHJcblx0XHRcdFx0XHRcdFx0YWRkV29yayhzZW5kT2JqKTtcclxuXHRcdFx0XHRcdFx0fSBlbHNlIHsgLy/msqHmnInop4bpopFcclxuXHRcdFx0XHRcdFx0XHRhZGRXb3JrKHNlbmRPYmopO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pXHJcblxyXG5cdFx0fSlcclxuXHJcblx0fVxyXG5cclxuXHRyZXR1cm4ge1xyXG5cdFx0aW5pdDogZnVuY3Rpb24oKSB7XHJcblx0XHRcdGFjdGl2aXR5SWQgPSBwbHVzLndlYnZpZXcuY3VycmVudFdlYnZpZXcoKS5hY3Rpdml0eUlkO1xyXG5cdFx0XHR2YXIgdmlkZW9OdW09aW5pdFBhZ2UoKTtcclxuXHRcdFx0YmluZEV2ZW50cygpO1xyXG5cdFx0XHRyZXR1cm4gdmlkZW9OdW07XHJcblx0XHR9LFxyXG5cdFx0YWRkT25lUGhvdG86YWRkT25lUGhvdG9cclxuXHR9XHJcbn0od2luZG93LCBtdWkpKTsiXX0=
